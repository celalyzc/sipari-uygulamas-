<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Garson Defteri</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
    font-family:Arial;
    margin:auto;
    background:#f5f5f5;
    max-width:500px;
    padding:8px;
    font-size:14px;
}
h2{text-align:center;margin-bottom:6px;font-size:18px}

button{
    border:none;
    border-radius:8px;
    font-size:14px;
    cursor:pointer;
}

#msg{
    position:fixed;
    top:15px;
    left:50%;
    transform:translateX(-50%);
    background:#333;
    color:white;
    padding:8px;
    border-radius:6px;
    display:none;
    z-index:999;
    font-size:13px;
}

#masalar{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:6px;
}

.masa-btn{
    padding:12px 0;
    font-size:14px;
    color:white;
}

#panel{
    display:none;
    background:white;
    padding:8px;
    border-radius:8px;
}

.menu-item{
    display:flex;
    justify-content:space-between;
    align-items:center;
    background:#eee;
    padding:6px;
    margin:4px 0;
    border-radius:6px;
    font-size:13px;
}

.adet-kontrol{
    display:flex;
    align-items:center;
    gap:6px;
}

.adet-kontrol button{
    width:28px;
    height:28px;
    font-size:16px;
    background:#ddd;
}

.siparis-kart{
    background:#eee;
    padding:8px;
    margin:5px 0;
    border-radius:6px;
    font-size:13px;
}
</style>
</head>

<body>

<div id="msg"></div>

<h2>üçΩ Garson Defteri</h2>

<button onclick="dagitimEkrani()" 
style="width:100%;padding:8px;background:#3498db;color:white;margin-bottom:6px">
üìã Daƒüƒ±tƒ±m
</button>

<div id="masalar"></div>

<div id="panel">
<button onclick="anaSayfa()" 
style="width:100%;padding:6px;background:#777;color:white;margin-bottom:6px">
‚¨Ö Geri
</button>
<div id="masaTitle" style="text-align:center;font-weight:bold;margin-bottom:6px"></div>
<div id="icerik"></div>
</div>

<script>

const MASA_SAYISI = 20;
let aktifMasa=null;
let temp={};

const menuData={
"Men√ºler":[
"Lahmacun Men√º",
"Tavuk ≈ûi≈ü Men√º",
"Beyti Men√º",
"Adana Men√º"
],
"Pideler":[
"Kƒ±ymalƒ± Pide",
"Ka≈üarlƒ± Pide",
"Ku≈üba≈üƒ±lƒ± Pide",
"Ku≈üba≈üƒ± Ka≈üarlƒ± Pide",
"Karƒ±≈üƒ±k Pide"
]
};

function mesaj(text){
let box=document.getElementById("msg");
box.innerText=text;
box.style.display="block";
setTimeout(()=>box.style.display="none",1500);
}

function anaSayfa(){
document.getElementById("panel").style.display="none";
document.getElementById("masalar").style.display="grid";
renderMasalar();
}

function renderMasalar(){
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
let html="";
for(let i=1;i<=MASA_SAYISI;i++){
let sip=db["masa"+i];
let renk=sip?"#2ecc71":"#e74c3c";
html+=`
<button class="masa-btn"
style="background:${renk}"
onclick="masaAc(${i})">
${i}
</button>`;
}
document.getElementById("masalar").innerHTML=html;
}

function masaAc(masa){
aktifMasa=masa;
temp={};

document.getElementById("masalar").style.display="none";
document.getElementById("panel").style.display="block";
document.getElementById("masaTitle").innerText="Masa "+masa;

let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
let sip=db["masa"+masa];

if(sip){
let html="";
for(let urun in sip.urunler){
let u=sip.urunler[urun];
html+=`
<div class="siparis-kart">
<b>${urun}</b><br>
${u.teslim} / ${u.adet}
<br>
<button onclick="teslimEt(${masa},'${urun}')"
style="width:100%;margin-top:4px;background:#27ae60;color:white;padding:4px">
‚úî Teslim
</button>
</div>`;
}
document.getElementById("icerik").innerHTML=html;
return;
}

let html="";
for(let kategori in menuData){
menuData[kategori].forEach(item=>{
let miktar=temp[item]||0;
let safeId=item.replace(/[^a-zA-Z0-9]/g,"_");
html+=`
<div class="menu-item">
<span>${item}</span>
<div class="adet-kontrol">
<button onclick="adet('${item}',-1)">-</button>
<span id="${safeId}">${miktar}</span>
<button onclick="adet('${item}',1)">+</button>
</div>
</div>`;
});
}
html+=`
<button onclick="kaydet()" 
style="width:100%;padding:6px;background:#2ecc71;color:white;margin-top:6px">
‚úî Sipari≈ü
</button>`;
document.getElementById("icerik").innerHTML=html;
}

function adet(item,deg){
if(!temp[item]) temp[item]=0;
temp[item]+=deg;
if(temp[item]<0) temp[item]=0;
let safeId=item.replace(/[^a-zA-Z0-9]/g,"_");
let el=document.getElementById(safeId);
if(el) el.innerText=temp[item];
}

function kaydet(){
let secilen=Object.entries(temp).filter(([k,v])=>v>0);
if(secilen.length===0){
mesaj("√úr√ºn se√ßmedin");
return;
}
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
let now=new Date();
let zaman=now.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"});
let urunObj={};
secilen.forEach(([urun,adet])=>{
urunObj[urun]={adet:adet,teslim:0};
});
db["masa"+aktifMasa]={urunler:urunObj,zaman:zaman};
localStorage.setItem("siparisler",JSON.stringify(db));
mesaj("Kaydedildi");
anaSayfa();
}

function teslimEt(masa,urun){
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
let sip=db["masa"+masa];
if(!sip)return;
let u=sip.urunler[urun];
if(u.teslim<u.adet) u.teslim++;
let hepsiBitti=Object.values(sip.urunler)
.every(x=>x.teslim===x.adet);
if(hepsiBitti){
delete db["masa"+masa];
mesaj("Masa tamamlandƒ±");
}
localStorage.setItem("siparisler",JSON.stringify(db));
masaAc(masa);
}

function dagitimEkrani(){
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
document.getElementById("masalar").style.display="none";
document.getElementById("panel").style.display="block";
document.getElementById("masaTitle").innerText="Daƒüƒ±tƒ±m";

let html="";
for(let masa in db){
let sip=db[masa];
for(let urun in sip.urunler){
let u=sip.urunler[urun];
if(u.teslim<u.adet){
html+=`
<div class="siparis-kart">
<b>${urun}</b><br>
${masa} ‚Üí ${u.adet-u.teslim}
<br>
<button onclick="teslimEt(${masa.replace('masa','')},'${urun}')"
style="width:100%;margin-top:4px;background:#27ae60;color:white;padding:4px">
‚úî Teslim
</button>
</div>`;
}
}
}
if(html==="") html="<p style='text-align:center'>T√ºm sipari≈üler bitti</p>";
document.getElementById("icerik").innerHTML=html;
}

anaSayfa();

</script>
</body>
</html>
