<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Garson Defteri</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
    font-family:Arial;
    background:#f5f5f5;
    max-width:500px;
    margin:auto;
    padding:8px;
    font-size:14px;
}
h2{text-align:center;margin-bottom:8px;font-size:18px}

button{
    border:none;
    border-radius:6px;
    padding:6px;
    font-size:13px;
}

#urunler button{
    width:100%;
    margin:3px 0;
    background:#ddd;
}

#dagitim{
    margin-top:8px;
}

.kart{
    background:#eee;
    padding:6px;
    margin:4px 0;
    border-radius:6px;
    font-size:13px;
}

.adet-btn{
    padding:4px 6px;
    font-size:12px;
    background:#27ae60;
    color:white;
}
</style>
</head>

<body>

<h2>ğŸ½ Garson Defteri</h2>

<div id="siparisGiris">
<select id="masaSelect" style="width:100%;padding:6px;margin-bottom:6px">
<option value="">Masa SeÃ§</option>
</select>

<div id="urunler"></div>

<button onclick="kaydet()" 
style="width:100%;margin-top:6px;background:#2ecc71;color:white">
SipariÅŸi Kaydet
</button>
</div>

<hr style="margin:8px 0">

<h3 style="text-align:center">ğŸ“‹ DaÄŸÄ±tÄ±m</h3>
<div id="dagitim"></div>

<script>

const MASA_SAYISI=20;

const urunList=[
"Lahmacun MenÃ¼",
"Tavuk ÅiÅŸ MenÃ¼",
"Beyti MenÃ¼",
"Adana MenÃ¼",
"KÄ±ymalÄ± Pide",
"KaÅŸarlÄ± Pide",
"KuÅŸbaÅŸÄ±lÄ± Pide",
"KuÅŸbaÅŸÄ± KaÅŸarlÄ± Pide",
"KarÄ±ÅŸÄ±k Pide"
];

let temp={};

function init(){
let masaSelect=document.getElementById("masaSelect");
for(let i=1;i<=MASA_SAYISI;i++){
masaSelect.innerHTML+=`<option value="${i}">Masa ${i}</option>`;
}

let urunDiv=document.getElementById("urunler");
urunList.forEach(u=>{
urunDiv.innerHTML+=`
<button onclick="adetArt('${u}')">
${u} (<span id="${idYap(u)}">0</span>)
</button>`;
});

dagitimGoster();
}

function idYap(text){
return text.replace(/[^a-zA-Z0-9]/g,"_");
}

function adetArt(urun){
if(!temp[urun]) temp[urun]=0;
temp[urun]++;
document.getElementById(idYap(urun)).innerText=temp[urun];
}

function kaydet(){
let masa=document.getElementById("masaSelect").value;
if(!masa) return alert("Masa seÃ§");

let secilen=Object.entries(temp).filter(([k,v])=>v>0);
if(secilen.length===0) return alert("ÃœrÃ¼n yok");

let db=JSON.parse(localStorage.getItem("siparisler")||"{}");

if(!db["masa"+masa]) db["masa"+masa]={};

secilen.forEach(([urun,adet])=>{
if(!db["masa"+masa][urun]) db["masa"+masa][urun]=0;
db["masa"+masa][urun]+=adet;
});

localStorage.setItem("siparisler",JSON.stringify(db));

temp={};
urunList.forEach(u=>{
document.getElementById(idYap(u)).innerText=0;
});

dagitimGoster();
}

function dagitimGoster(){
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
let html="";

urunList.forEach(urun=>{
let satir="";
for(let masa in db){
if(db[masa][urun]){
satir+=`
<div class="kart">
${urun} â†’ ${masa.replace("masa","M")} 
(${db[masa][urun]})
<button class="adet-btn"
onclick="teslim('${masa}','${urun}')">
âœ”
</button>
</div>`;
}
}
html+=satir;
});

document.getElementById("dagitim").innerHTML=html;
}

function teslim(masa,urun){
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");

db[masa][urun]--;
if(db[masa][urun]<=0){
delete db[masa][urun];
}
if(Object.keys(db[masa]).length===0){
delete db[masa];
}

localStorage.setItem("siparisler",JSON.stringify(db));
dagitimGoster();
}

init();

</script>
</body>
</html>
