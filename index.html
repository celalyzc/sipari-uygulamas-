<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Garson Defteri PRO</title>

<style>
*{box-sizing:border-box}
body{
    font-family:Arial;
    margin:auto;
    background:#f5f5f5;
    max-width:600px;
    padding:10px;
}
h2{text-align:center}

button{
    width:100%;
    padding:18px;
    font-size:18px;
    border:none;
    border-radius:10px;
    margin:5px 0;
}

#msg{
    position:fixed;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    background:#333;
    color:white;
    padding:12px;
    border-radius:8px;
    display:none;
    z-index:999;
}

#masalar{
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:10px;
}

#panel{
    display:none;
    background:white;
    padding:15px;
    border-radius:10px;
}

.menu-item{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:12px;
    background:#eee;
    border-radius:8px;
    margin:8px 0;
}

.siparis-kart{
    padding:15px;
    margin:10px 0;
    background:#eee;
    border-radius:10px;
}
</style>
</head>

<body>

<div id="msg"></div>

<h2>ğŸ½ Garson Defteri PRO</h2>

<button onclick="dagitimEkrani()" style="background:#3498db;color:white">
ğŸ“‹ DaÄŸÄ±tÄ±m EkranÄ±
</button>

<div id="masalar"></div>

<div id="panel">
<button onclick="anaSayfa()" style="background:#777;color:white">
â¬… Geri
</button>
<div id="masaTitle"></div>
<div id="icerik"></div>
</div>

<script>

const MASA_SAYISI = 20;

let aktifMasa = null;
let temp = {};

const menuData = {
"ğŸ” TAVUK":[
"Tavuk GermeÃ§ Ekmek",
"Tavuk GermeÃ§ DÃ¼rÃ¼m",
"Tavuk ÅiÅŸ",
"Tavuk Kanat"
],
"ğŸ¥© ET":[
"KÃ¶fte Ekmek",
"Adana Kebap",
"Urfa Kebap",
"KarÄ±ÅŸÄ±k Izgara"
],
"ğŸ«“ PÄ°DE":[
"KÄ±ymalÄ± Pide",
"KuÅŸbaÅŸÄ±lÄ± Pide",
"Lahmacun (AcÄ±lÄ±)",
"Lahmacun (AcÄ±sÄ±z)"
],
"ğŸ¥¤ Ä°Ã‡ECEK":[
"Kola",
"Ayran",
"Su"
]
};

function mesaj(text){
let box=document.getElementById("msg");
box.innerText=text;
box.style.display="block";
setTimeout(()=>box.style.display="none",2000);
}

function anaSayfa(){
document.getElementById("panel").style.display="none";
document.getElementById("masalar").style.display="grid";
renderMasalar();
}

function renderMasalar(){
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
let html="";
for(let i=1;i<=MASA_SAYISI;i++){
let sip=db["masa"+i];
let renk=sip?"#2ecc71":"#e74c3c";
html+=`
<button style="background:${renk};color:white"
onclick="masaAc(${i})">
Masa ${i}
</button>`;
}
document.getElementById("masalar").innerHTML=html;
}

function masaAc(masa){
aktifMasa=masa;
temp={};

document.getElementById("masalar").style.display="none";
document.getElementById("panel").style.display="block";
document.getElementById("masaTitle").innerText="Masa "+masa;

let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
let sip=db["masa"+masa];

if(sip){
let html=`<h3>ğŸ“‹ SipariÅŸ</h3><p>â° ${sip.zaman}</p>`;
for(let urun in sip.urunler){
let u=sip.urunler[urun];
html+=`
<div class="siparis-kart">
<b>${urun}</b><br>
${u.teslim} / ${u.adet}
<br><br>
<button onclick="teslimEt(${masa},'${urun}')"
style="background:#27ae60;color:white">
âœ” Teslim
</button>
</div>`;
}
document.getElementById("icerik").innerHTML=html;
return;
}

let html="";
for(let kategori in menuData){
html+=`
<button onclick="toggleKategori('${kategori}')"
style="background:#ddd">
${kategori}
</button>
<div id="menu_${kategori}"></div>`;
}
html+=`
<button onclick="kaydet()"
style="background:#2ecc71;color:white;margin-top:15px">
ğŸ½ SipariÅŸ OluÅŸtur
</button>`;
document.getElementById("icerik").innerHTML=html;
}

function toggleKategori(kategori){
let el=document.getElementById("menu_"+kategori);
if(el.innerHTML!=""){el.innerHTML="";return;}
let liste="";
menuData[kategori].forEach(item=>{
let miktar=temp[item]||0;
let safeId=item.replace(/[^a-zA-Z0-9]/g,"_");
liste+=`
<div class="menu-item">
<span>${item}</span>
<div>
<button onclick="adet('${item}',-1)">-</button>
<span id="${safeId}" style="margin:0 10px">${miktar}</span>
<button onclick="adet('${item}',1)">+</button>
</div>
</div>`;
});
el.innerHTML=liste;
}

function adet(item,deg){
if(!temp[item]) temp[item]=0;
temp[item]+=deg;
if(temp[item]<0) temp[item]=0;
let safeId=item.replace(/[^a-zA-Z0-9]/g,"_");
let el=document.getElementById(safeId);
if(el) el.innerText=temp[item];
}

function kaydet(){
let secilen=Object.entries(temp).filter(([k,v])=>v>0);
if(secilen.length===0){
mesaj("âš  ÃœrÃ¼n seÃ§medin");
return;
}
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
let now=new Date();
let zaman=now.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"});
let urunObj={};
secilen.forEach(([urun,adet])=>{
urunObj[urun]={adet:adet,teslim:0};
});
db["masa"+aktifMasa]={urunler:urunObj,zaman:zaman};
localStorage.setItem("siparisler",JSON.stringify(db));
mesaj("âœ… SipariÅŸ kaydedildi");
anaSayfa();
}

function teslimEt(masa,urun){
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
let sip=db["masa"+masa];
if(!sip)return;
let u=sip.urunler[urun];
if(u.teslim<u.adet) u.teslim++;
let hepsiBitti=Object.values(sip.urunler)
.every(x=>x.teslim===x.adet);
if(hepsiBitti){
delete db["masa"+masa];
mesaj("ğŸ‰ Masa tamamlandÄ±!");
}
localStorage.setItem("siparisler",JSON.stringify(db));
masaAc(masa);
}

function dagitimEkrani(){
let db=JSON.parse(localStorage.getItem("siparisler")||"{}");
document.getElementById("masalar").style.display="none";
document.getElementById("panel").style.display="block";
document.getElementById("masaTitle").innerText="ğŸ“‹ Aktif SipariÅŸler";

let html="";
for(let masa in db){
let sip=db[masa];
for(let urun in sip.urunler){
let u=sip.urunler[urun];
if(u.teslim<u.adet){
html+=`
<div class="siparis-kart">
<b>${urun}</b><br>
${masa} â†’ ${u.adet-u.teslim} adet
<br><br>
<button onclick="teslimEt(${masa.replace('masa','')},'${urun}')"
style="background:#27ae60;color:white">
âœ” Teslim Et
</button>
</div>`;
}
}
}
if(html===""){
html="<h3 style='text-align:center'>TÃ¼m sipariÅŸler tamamlandÄ± ğŸ‰</h3>";
}
document.getElementById("icerik").innerHTML=html;
}

anaSayfa();

</script>
</body>
</html>
